<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
	<title>test</title>
	<style type="text/css">
		canvas{
			border:1px solid black;
			background: #fff;
		}
	</style>
</head>
<body>
	<canvas></canvas>
	<script src = "mapData.js"></script>
	<script>
		var d = JSON.parse(JSON.stringify(mapData));
		mapData = mapData[1];
		var shapeData = mapData.shape;
		var arr;

		ctx = document.querySelector("canvas").getContext("2d");
		document.querySelector("canvas").width = mapData.map?mapData.map.width:3000;
		document.querySelector("canvas").height = mapData.map?mapData.map.height:1000;
		
		draw(ctx, shapeData);

		function draw(ctx, shape){
			for(var type in shape){
				arr = shape[type];
				ctx.save();

				if(type == "bezier")
				{
					ctx.strokeStyle = "#9966ff";
					arr.forEach(function(data){
						ctx.beginPath();
						var p = data.shift();
						if(p.color){
							ctx.globalAlpha = Number("0x"+p.color.slice(-2))/255;
							ctx.fillStyle = p.color.slice(0, 7);
						}
						else{
							ctx.globalAlpha = 1;
							ctx.fillStyle = "#000";
						}
						ctx.moveTo(p.points[0].x, p.points[0].y);
						ctx.quadraticCurveTo(p.points[1].x, p.points[1].y, p.points[2].x, p.points[2].y);
						data.forEach(function(p){
							ctx.quadraticCurveTo(p.points[1].x, p.points[1].y, p.points[2].x, p.points[2].y);
						});
						ctx.stroke();
						ctx.fill();	
					});	
				}
				else if(type == "rect")
				{
					arr.forEach(function(data){
						if(data.color.length>7){
							ctx.globalApha = Number("0x"+data.color.slice(-2))/255;
							data.color = data.color.slice(0, 7);
						}
						ctx.fillStyle = data.color;
						ctx.fillRect(data.x, data.y, data.width, data.height);
						ctx.strokeRect(data.x, data.y, data.width, data.height);
					});		
				}
				ctx.restore();
			}
		}
	</script>
</body>
</html>